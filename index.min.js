"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};(function(){if(!Array.isArray){Array.isArray=function isArray(arr){return Object.prototype.toString.call(arr)==="[object Array]"}}function isAllFunc(funcs){if(typeof funcs==="function"){return true}else if(Array.isArray(funcs)){for(var i=0;i<funcs.length;i++){if(typeof funcs[i]!=="function"){return false}}return true}return false}function parallel(funcs,callback,payload){var len=funcs.length;var results=[];var i=0;var error=null;var stop=false;if(len===0){callback(null,results);return}var next=function next(_err,result){if(stop)return;var err=_err||error;if(err){stop=true;callback(err)}else{results.push(result);i+=1;if(i===len){stop=true;callback(null,results)}}};for(var j=0;j<len;j++){try{funcs[j](next,payload)}catch(e){error=e}}}function serial(funcs,callback,payload){var len=funcs.length;var results=[];var i=0;var error=null;var stop=false;if(len===0){callback(null,results);return}var next=function next(_err,result){if(stop)return;var err=_err||error;if(err){stop=true;callback(err)}else{i+=1;results.push(result);if(i===len){stop=true;callback(null,results)}else{try{funcs[i](next,result)}catch(e){error=e}}}};try{funcs[i](next,payload)}catch(e){error=e}}function step(){for(var _len=arguments.length,tasks=Array(_len),_key=0;_key<_len;_key++){tasks[_key]=arguments[_key]}for(var i=0;i<tasks.length;i++){if(!isAllFunc(tasks[i])){throw new Error('Invalid params for "function step()"')}}var serialList=tasks.map(function(task){if(Array.isArray(task)){return function(next,payload){parallel(task,function(){var err=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var result=arguments[1];next(err,result)},payload)}}return task});return function(callback,payload){serial(serialList,callback,payload)}}if(typeof module!=="undefined"&&(typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=step}else if(typeof define==="function"&&(define.amd||define.cmd)){define(function(){return step})}else{this.step=step}}).call(undefined||(typeof window!=="undefined"?window:global));